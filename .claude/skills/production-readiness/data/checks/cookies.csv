Check,Keywords,Severity,Category,Description,Requirement,Code Example,Common Mistakes
Consent Banner,cookie consent banner gdpr,CRITICAL,Consent,Display cookie consent banner before setting non-essential cookies,Must appear on first visit with clear Accept/Reject options,"// components/cookie-banner.tsx
'use client';
import { useState, useEffect } from 'react';
export function CookieBanner() {
  const [consent, setConsent] = useState<string | null>(null);
  useEffect(() => {
    setConsent(localStorage.getItem('cookie-consent'));
  }, []);
  if (consent) return null;
  return (
    <div className=""fixed bottom-0 inset-x-0 p-4 bg-white shadow-lg"">
      <p>{t('cookies.message')}</p>
      <div className=""flex gap-2"">
        <button onClick={() => handleConsent('all')}>{t('cookies.acceptAll')}</button>
        <button onClick={() => handleConsent('necessary')}>{t('cookies.rejectAll')}</button>
        <button onClick={() => setShowSettings(true)}>{t('cookies.customize')}</button>
      </div>
    </div>
  );
}",Pre-checked boxes unequal button prominence
Category Selection,cookie category necessary analytics marketing,HIGH,Consent,Allow users to select cookie categories,Separate toggles for necessary analytics and marketing cookies,"const cookieCategories = {
  necessary: { enabled: true, locked: true }, // Always on
  analytics: { enabled: false }, // Opt-in
  marketing: { enabled: false }, // Opt-in
  preferences: { enabled: false }, // Opt-in
};",Bundling all cookies together no granular control
Consent Storage,consent storage record proof,HIGH,Compliance,Store consent choice with timestamp,Store consent record for audit purposes,"function handleConsent(choice: string) {
  const consent = {
    choice,
    timestamp: new Date().toISOString(),
    version: '1.0',
  };
  localStorage.setItem('cookie-consent', JSON.stringify(consent));
  // Also send to backend for audit trail
  await fetch('/api/consent', {
    method: 'POST',
    body: JSON.stringify(consent),
  });
}",Not storing timestamp or consent version
Script Loading,conditional script analytics tracking,HIGH,Implementation,Only load tracking scripts after consent,Conditionally load scripts based on consent,"// Check consent before loading
const consent = getConsent();
if (consent?.analytics) {
  // Load analytics
  <Script
    src=""https://analytics.example.com/script.js""
    strategy=""afterInteractive""
  />
}",Loading scripts before consent
Easy Withdrawal,withdraw consent change preferences,CRITICAL,Rights,Users must be able to easily withdraw consent,Accessible link to change preferences,"// In footer or settings
<button onClick={() => setShowCookieSettings(true)}>
  {t('cookies.managePreferences')}
</button>
// Reset consent
function withdrawConsent() {
  localStorage.removeItem('cookie-consent');
  // Remove tracking cookies
  document.cookie.split(';').forEach(c => {
    if (!isNecessaryCookie(c)) {
      document.cookie = c.replace(/^ +/, '').replace(/=.*/, '=;expires=Thu, 01 Jan 1970');
    }
  });
  location.reload();
}",Hidden or hard to find option
Cookie Policy,cookie policy page documentation,HIGH,Documentation,Publish detailed cookie policy,List all cookies their purpose and duration,"Create /cookies page with:
- What cookies are
- Categories used
- List of each cookie (name, purpose, duration, provider)
- How to manage cookies
- Contact information",Vague or incomplete policy
Secure Attributes,secure httponly samesite cookie,HIGH,Security,Session cookies must have secure attributes,HttpOnly Secure SameSite=Lax,"// Set secure cookie
response.cookies.set('session', token, {
  httpOnly: true,
  secure: process.env.NODE_ENV === 'production',
  sameSite: 'lax',
  maxAge: 60 * 60 * 24 * 30, // 30 days
});",Missing secure flags on sensitive cookies
GPC Support,gpc global privacy control do not track,MEDIUM,Privacy,Honor Global Privacy Control signal,Detect and honor GPC header,"// In middleware or API
const gpc = request.headers.get('Sec-GPC');
if (gpc === '1') {
  // User has opted out - treat as rejected consent
  // Don't set analytics/marketing cookies
}",Ignoring GPC signals (required by CCPA)
